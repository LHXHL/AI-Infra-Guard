from deepteam.vulnerabilities import CustomVulnerability
from deepteam.attacks.single_turn import Raw
from deepeval.models import GPTModel
from deepteam import red_team

api_security = CustomVulnerability(
    name="API Security",
    types=["endpoint_exposure", "auth_bypass"],
)


async def model_callback(input: str):
    model = GPTModel()
    response, _ = await model.a_generate(input)
    return response


risk_assessment = red_team(
    vulnerabilities=[api_security],
    model_callback=model_callback,
    attacks=[Raw()],
    target_purpose="Chatbot Assistant",
)
for test_case in risk_assessment.test_cases:
    print(test_case)
