info:
  name: ComfyUI-Impact-Pack-PathTraversal
  cve: CVE-2024-21575
  summary: ComfyUI-Impact-Pack Path Traversal Vulnerability
  details: |
    ComfyUI-Impact-Pack is vulnerable to Path Traversal due to missing validation of the `image.filename` field in a POST request sent to the `/upload/temp` endpoint. This allows writing arbitrary files to the file system, potentially leading to remote code execution (RCE) under certain conditions.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
  severity: CRITICAL
  security_advise: |
    1. Immediately update to the latest version of ComfyUI-Impact-Pack.
    2. Review and implement proper input validation for file uploads.
    3. Monitor for any suspicious file system activity.
rule: version < "1.4.0" # Assuming the vulnerability is fixed in version 1.4.0 or later
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-21575
  - https://github.com/ltdrdata/ComfyUI-Impact-Pack/commit/a43dae373e648ae0f0cc0c9768c3cea6a72acff7
  - https://github.com/ltdrdata/ComfyUI-Impact-Pack/blob/1087f2ee063c9d53cd198add79b41a7a3465c05a/modules/impact/impact_server.py#L28