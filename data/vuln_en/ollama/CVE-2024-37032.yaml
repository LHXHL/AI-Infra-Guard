info:
  name: ollama-digest-validation-vulnerability
  cve: CVE-2024-37032
  summary: Ollama does not validate the format of the digest (sha256 with 64 hex digits)
  details: |
    Ollama before version 0.1.34 does not properly validate the format of the digest, which should be a sha256 hash consisting of 64 hex digits. This vulnerability allows for mishandling of various test cases, including those with fewer or more than 64 hex digits, or an initial `../` substring, potentially leading to security issues.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
  severity: MEDIUM
  security_advise: |
    1. Upgrade to ollama version 0.1.34 or later.
    2. Review and test the changes made in version 0.1.34 to ensure that the digest validation is correctly implemented.
    3. Monitor for any further updates or patches related to this vulnerability.
rule: version < "0.1.34"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-37032
  - https://github.com/ollama/ollama/pull/4175
  - https://github.com/ollama/ollama/commit/2a21363bb756a7341d3d577f098583865bd7603f
  - https://github.com/advisories/GHSA-8hqg-whrw-pv92
  - https://github.com/ollama/ollama
  - https://github.com/ollama/ollama/blob/adeb40eaf29039b8964425f69a9315f9f1694ba8/server/modelpath_test.go#L41-L58
  - https://github.com/ollama/ollama/compare/v0.1.33...v0.1.34
  - https://pkg.go.dev/vuln/GO-2024-2901
  - https://www.vicarius.io/vsociety/posts/probllama-in-ollama-a-tale-of-a-yet-another-rce-vulnerability-cve-2024-37032