info:
  name: ollama-zip-extraction-vulnerability
  cve: CVE-2024-45436
  summary: Ollama can extract members of a ZIP archive outside of the parent directory
  details: |
    The `extractFromZipFile` function in `model.go` within Ollama versions prior to 0.1.47 
    is susceptible to an arbitrary file write vulnerability. This allows attackers to 
    extract ZIP archive members to locations outside the intended parent directory.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade to Ollama version 0.1.47 or later.
    2. Review and validate all ZIP file handling to ensure extraction is confined to the intended directory.
    3. Implement additional security checks around file extraction processes to prevent similar vulnerabilities.
rule: version < "0.1.47"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-45436
  - https://github.com/ollama/ollama/pull/5314
  - https://github.com/ollama/ollama/commit/123a722a6f541e300bc8e34297ac378ebe23f527
  - https://github.com/ollama/ollama
  - https://github.com/ollama/ollama/compare/v0.1.46...v0.1.47