info:
  name: kubepi-password-leak
  cve: CVE-2023-37916
  summary: KubePi may leak password hash of any user
  details: |
    The KubePi API endpoint `/kubepi/api/v1/users/search` leaks the password hash of any user (including admin) when accessed with specific parameters. This vulnerability can lead to password cracking attacks.
    
    ### PoC
    https://drive.google.com/file/d/1ksdawJ1vShRJyT3wAgpqVmz-Ls6hMA7M/preview
    
    ### Impact
    - Leaking confidential information.
    - Can lead to password cracking attacks.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade to KubePi version 1.6.5 or higher.
    2. Review and enforce stronger access controls around the user search API endpoint.
    3. Implement hashing algorithms with higher computational complexity to mitigate cracking risks.
rule: version < "1.6.5"
references:
  - https://github.com/1Panel-dev/KubePi/security/advisories/GHSA-87f6-8gr7-pc6h
  - https://nvd.nist.gov/vuln/detail/CVE-2023-37916
  - https://drive.google.com/file/d/1ksdawJ1vShRJyT3wAgpqVmz-Ls6hMA7M/preview
  - https://github.com/1Panel-dev/KubePi
  - https://github.com/1Panel-dev/KubePi/releases/tag/v1.6.5