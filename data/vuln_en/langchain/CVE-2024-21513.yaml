info:
  name: langchain-arbitrary-code-execution
  cve: CVE-2024-21513
  summary: langchain-experimental vulnerable to Arbitrary Code Execution
  details: |
    Versions of the package langchain-experimental from 0.0.15 and before 0.0.21 are vulnerable to Arbitrary Code Execution when retrieving values from the database, as the code attempts to call 'eval' on all values. An attacker can exploit this vulnerability and execute arbitrary Python code if they can control the input prompt and the server is configured with VectorSQLDatabaseChain.
    **Impact:**
    - **Confidentiality:** Full access to the impacted component's resources.
    - **Integrity:** Compromised trustworthiness of returned information.
    - **Availability:** Potential loss of availability due to post-exploitation actions.
    **Attack Requirements:** An attacker needs to influence the input prompt while the server is configured with the VectorSQLDatabaseChain plugin.
  cvss: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. Upgrade to langchain-experimental >= 0.0.21.
    2. Review and sanitize all inputs to prevent code injection.
    3. Disable or replace the VectorSQLDatabaseChain plugin if not necessary.
rule: version < "0.0.21"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-21513
  - https://github.com/langchain-ai/langchain/commit/7b13292e3544b2f5f2bfb8a27a062ea2b0c34561
  - https://github.com/langchain-ai/langchain
  - https://github.com/langchain-ai/langchain/blob/672907bbbb7c38bf19787b78e4ffd7c8a9026fe4/libs/experimental/langchain_experimental/sql/vector_sql.py#L81
  - https://github.com/pypa/advisory-database/tree/main/vulns/langchain-experimental/PYSEC-2024-62.yaml
  - https://security.snyk.io/vuln/SNYK-PYTHON-LANGCHAINEXPERIMENTAL-7278171