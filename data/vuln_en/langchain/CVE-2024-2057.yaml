info:
  name: langchain-server-side-request-forgery
  cve: CVE-2024-2057
  summary: Server-side request forgery vulnerability in LangChain
  details: |
    A vulnerability was found in Harrison Chase LangChain 0.1.9. It has been classified as critical. Affected is the function load_local in the library libs/community/langchain_community/retrievers/tfidf.py. The manipulation leads to server-side request forgery. It is possible to launch the attack remotely.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
  severity: CRITICAL
  security_advise: |
    1. Upgrade to LangChain version 0.1.10 or later.
    2. Review and update the load_local function in libs/community/langchain_community/retrievers/tfidf.py to prevent SSRF attacks.
    3. Implement strict input validation for all external requests.
rule: version < "0.1.10"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-2057
  - https://github.com/langchain-ai/langchain/pull/18695
  - https://github.com/bayuncao/vul-cve-16
  - https://github.com/bayuncao/vul-cve-16/tree/main/PoC.pkl
  - https://vuldb.com/?ctiid.255372
  - https://vuldb.com/?id.255372