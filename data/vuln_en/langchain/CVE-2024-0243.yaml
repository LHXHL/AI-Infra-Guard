info:
  name: langchain-ssrf-vulnerability
  cve: CVE-2024-0243
  summary: langchain Server-Side Request Forgery vulnerability
  details: |
    An attacker in control of the contents of a specified URL could place a malicious HTML file with links to completely different domains.
    The crawler, despite having `prevent_outside=True`, would proceed to download files from these unauthorized domains.
    This issue arises from improper handling of URLs within the crawler's configuration.
  cvss: CVSS:3.0/AV:L/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:N
  severity: LOW
  security_advise: |
    1. Upgrade to langchain version 0.1.0 or higher.
    2. Review and adjust crawler configurations to ensure `prevent_outside` is properly enforced.
    3. Regularly update and patch the langchain package to mitigate future vulnerabilities.
rule: version < "0.1.0"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-0243
  - https://github.com/langchain-ai/langchain/pull/15559
  - https://github.com/langchain-ai/langchain/commit/bf0b3cc0b5ade1fb95a5b1b6fa260e99064c2e22
  - https://github.com/langchain-ai/langchain/blob/bf0b3cc0b5ade1fb95a5b1b6fa260e99064c2e22/libs/community/langchain_community/document_loaders/recursive_url_loader.py#L51-L51
  - https://github.com/pypa/advisory-database/tree/main/vulns/langchain-exa/PYSEC-2024-235.yaml
  - https://huntr.com/bounties/370904e7-10ac-40a4-a8d4-e2d16e1ca861