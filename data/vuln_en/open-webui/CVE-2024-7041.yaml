info:
  name: open-webui-idor-vulnerability
  cve: CVE-2024-7041
  summary: Insecure Direct Object Reference (IDOR) vulnerability in open-webui
  details: |
    An Insecure Direct Object Reference (IDOR) vulnerability exists in open-webui/open-webui version v0.3.8.
    The vulnerability occurs in the API endpoint `http://0.0.0.0:3000/api/v1/memories/{id}/update`,
    where the decentralization design is flawed, allowing attackers to edit other users' memories without proper authorization.
  cvss: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
  severity: MEDIUM
  security_advise: |
    1. Upgrade to open-webui >= 0.3.9
    2. Implement proper authorization checks in the `memories` endpoint
    3. Review and update all API endpoints to prevent未经授权的访问
rule: version = "0.3.8"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-7041
  - https://github.com/open-webui/open-webui
  - https://github.com/open-webui/open-webui/blob/main/backend/apps/webui/routers/memories.py#L71
  - https://huntr.com/bounties/6855227f-1237-47b8-8d37-29aad7ddec3a