info:
  name: pyload-ng
  cve: CVE-2024-21644
  summary: Pyload Unauthenticated Flask Configuration Leakage vulnerability
  details: |
    Any unauthenticated user can browse to a specific URL to expose the Flask configuration, including the `SECRET_KEY` variable. This can be exploited by accessing `http://localhost:8000/render/info.html` in a default configuration.
    
    The vulnerability arises because the `info.html` template inadvertently displays the Flask configuration when accessed without authentication. This is due to the route `/render/<path:filename>` allowing any template to be loaded without proper context, and the `config` variable not being overwritten as intended.
    
    Impact: Depending on how the Flask config data is used, it could have detrimental consequences for security. It's crucial to keep the `SECRET_KEY` secret and never expose it.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade to pyload-ng >= 0.5.0b3.dev77
    2. Review and restrict access to all internal configuration endpoints
    3. Implement authentication for all administrative and configuration interfaces
rule: version < "0.5.0b3.dev77"
references:
  - https://github.com/pyload/pyload/security/advisories/GHSA-mqpq-2p68-46fv
  - https://nvd.nist.gov/vuln/detail/CVE-2024-21644
  - https://github.com/pyload/pyload/commit/bb22063a875ffeca357aaf6e2edcd09705688c40
  - https://github.com/pyload/pyload