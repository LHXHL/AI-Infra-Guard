info:
  name: anythingllm-stored-xss
  cve: CVE-2024-3570
  summary: Stored Cross-Site Scripting (XSS) vulnerability in AnythingLLM chat functionality
  details: |
    A stored XSS vulnerability exists in the chat functionality of the mintplex-labs/anything-llm repository. 
    Attackers can execute arbitrary JavaScript by manipulating ChatBot responses, potentially leading to 
    unauthorized actions such as creating new admin accounts or changing user passwords, resulting in 
    complete application takeover. The vulnerability arises from improper sanitization of user and 
    ChatBot input, particularly through the use of `dangerouslySetInnerHTML`.
  cvss: CVSS:3.0/AV:L/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:N
  severity: HIGH
  security_advise: |
    1. Immediately update to the latest version of AnythingLLM that addresses this vulnerability.
    2. Review and enhance input sanitization practices, especially for data used in `dangerouslySetInnerHTML`.
    3. Implement strict content security policies (CSP) to mitigate the risk of XSS attacks.
    4. Regularly audit and monitor for any suspicious activities related to chat functionalities.
rule: version < "latest" # Placeholder rule, as specific version fixing the issue is not provided
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-3570
  - https://github.com/mintplex-labs/anything-llm/commit/a4ace56a401ffc8ce0082d7444159dfd5dc28834
  - https://huntr.com/bounties/f0eaf552-aaf3-42b6-a5df-cfecd2de15ee