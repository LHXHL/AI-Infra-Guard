info:
  name: anythingllm
  cve: CVE-2024-0759
  summary: Vulnerability in AnythingLLM allows internal network link scraping with manager or admin permissions.
  details: |
    If AnythingLLM is hosted on an internal network and an attacker is granted manager or admin permissions, they can perform link scraping to discover internally resolving IPs of other services on the same network. This requires the attacker to guess these internal IPs, which could be brute forced. There is a duty of care that other services on the same network should not be fully open and accessible via a simple CuRL with zero authentication.
  cvss: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N
  severity: CRITICAL
  security_advise: |
    1. Ensure that AnythingLLM instances are not hosted on internal networks unless absolutely necessary.
    2. Restrict permissions to the minimum required level for all users.
    3. Implement additional security measures such as IP whitelisting for accessing AnythingLLM.
    4. Regularly audit and monitor network traffic for suspicious activities.
rule: version > "0"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-0759
  - https://github.com/mintplex-labs/anything-llm/commit/0db6c3b2aa1787a7054ffdaba975474f122c20eb
  - https://huntr.com/bounties/9a978edd-ac94-41fc-8e3e-c35441bdd12b