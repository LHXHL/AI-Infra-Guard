info:
  name: anythingllm-path-traversal
  cve: CVE-2024-5211
  summary: Path traversal vulnerability in anything-llm allows unauthorized file access and manipulation.
  details: |
    A path traversal vulnerability exists in mintplex-labs/anything-llm, allowing a manager to bypass 
    the `normalizePath()` function. This enables the manager to read, delete, or overwrite 
    critical files such as 'anythingllm.db' in the 'storage' directory, including internal 
    communication keys and .env secrets. This could lead to application compromise, denial of 
    service (DoS) attacks, and unauthorized admin account takeover.
  cvss: CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. Immediately apply the patch provided in the GitHub commit: https://github.com/mintplex-labs/anything-llm/commit/e208074ef4c240fe03e4147ab097ec3b52b97619
    2. Review and enhance input validation for all file path operations.
    3. Regularly audit and monitor file system access to detect and respond to unauthorized activities promptly.
rule: version < "1.4.0" # Assuming the vulnerability is in version 1.4.0 and has been fixed in a later version
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-5211
  - https://github.com/mintplex-labs/anything-llm/commit/e208074ef4c240fe03e4147ab097ec3b52b97619
  - https://huntr.com/bounties/38f282cb-7226-435e-9832-2d4a102dad4b