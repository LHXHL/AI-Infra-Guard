info:
  name: anythingllm-data-exfiltration
  cve: CVE-2024-0765
  summary: Data exfiltration vulnerability in AnythingLLM
  details: |
    As a default user on a multi-user instance of AnythingLLM, it is possible to execute a call to the `/export-data` endpoint and then unzip and read the export to exfiltrate data of the system at that save state. This requires explicit access to the system but can be done at any role. Additionally, post-download, the data is deleted so no evidence would exist that exfiltration occurred.
  cvss: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N
  severity: CRITICAL
  security_advise: |
    1. Review and restrict access to the `/export-data` endpoint to authorized personnel only.
    2. Implement monitoring and alerting for unusual activity related to data exports.
    3. Regularly audit user permissions and roles to ensure they align with job functions.
rule: ""
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-0765
  - https://github.com/mintplex-labs/anything-llm/commit/08d33cfd8fc47c5052b6ea29597c964a9da641e2
  - https://huntr.com/bounties/8978ab27-710c-44ce-bfd8-a2ea416dc786