info:
  name: vllm
  cve: CVE-2025-24357
  summary: Malicious model to RCE by torch.load in hf_model_weights_iterator
  details: |
    The `vllm/model_executor/weight_utils.py` module implements `hf_model_weights_iterator` to load model checkpoints downloaded from Hugging Face. It utilizes the `torch.load` function with the default `weights_only` parameter set to `False`. There is a security warning on [PyTorch's official documentation](https://pytorch.org/docs/stable/generated/torch.load.html) regarding the execution of arbitrary code during the unpickling process when loading malicious pickle data.
    **Impact:** This vulnerability allows attackers to execute arbitrary code and OS commands on victim machines that remotely fetch pretrained repositories.
    *Note:* Most models now use the safetensors format, which is not susceptible to this issue.
  cvss: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
  severity: HIGH
  security_advise: |
    1. Upgrade to vllm version 0.7.0 or higher.
    2. Ensure that all model weights are fetched from trusted sources.
    3. Consider using alternative methods to load model weights that do not involve `torch.load` with `weights_only=False`.
rule: version >= "0" && version < "0.7.0"
references:
  - https://github.com/vllm-project/vllm/security/advisories/GHSA-rh4j-5rhw-hr54
  - https://nvd.nist.gov/vuln/detail/CVE-2025-24357
  - https://github.com/vllm-project/vllm/pull/12366
  - https://github.com/vllm-project/vllm/commit/d3d6bb13fb62da3234addf6574922a4ec0513d04
  - https://github.com/vllm-project/vllm/releases/tag/v0.7.0
  - https://pytorch.org/docs/stable/generated/torch.load.html