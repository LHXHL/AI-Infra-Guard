info:
  name: vllm
  cve: CVE-2025-24357
  summary: Malicious model to RCE by torch.load in hf_model_weights_iterator
  details: |
    The vllm/model_executor/weight_utils.py implements hf_model_weights_iterator to load the model checkpoint, which is downloaded from Hugging Face. It uses the torch.load function with the weights_only parameter set to its default value of False. There is a security warning on [PyTorch's documentation](https://pytorch.org/docs/stable/generated/torch.load.html) that states torch.load can execute arbitrary code during unpickling if malicious pickle data is loaded.
    This vulnerability can be exploited to execute arbitrary codes and OS commands on the victim machine that fetches the pretrained repo remotely. Note that most models now use the safetensors format, which is not vulnerable to this issue.
  cvss: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
  severity: HIGH
  security_advise: |
    1. Upgrade to vllm >= 0.7.0
    2. Ensure that all models are in the safetensors format to avoid this vulnerability
    3. Regularly check for updates and security advisories from the vllm project and PyTorch
rule: version < "0.7.0"
references:
  - https://github.com/vllm-project/vllm/security/advisories/GHSA-rh4j-5rhw-hr54
  - https://nvd.nist.gov/vuln/detail/CVE-2025-24357
  - https://github.com/vllm-project/vllm/pull/12366
  - https://github.com/vllm-project/vllm/commit/d3d6bb13fb62da3234addf6574922a4ec0513d04
  - https://github.com/vllm-project/vllm
  - https://github.com/vllm-project/vllm/releases/tag/v0.7.0
  - https://pytorch.org/docs/stable/generated/torch.load.html