info:
  name: comfy_mtb_code_injection
  cve: CVE-2024-12952
  summary: Critical code injection vulnerability in melMass comfy_mtb up to version 0.1.4
  details: |
    A vulnerability classified as critical was found in the `run_command` function of the `comfy_mtb/endpoint.py` file. 
    This vulnerability allows remote attackers to inject and execute arbitrary code due to improper handling of command execution.
    The exploit has been disclosed to the public and may be used. A patch is available to fix this issue.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
  severity: CRITICAL
  security_advise: |
    1. Immediately apply the patch named d6e004cce2c32f8e48b868e66b89f82da4887dc3.
    2. Upgrade to a version of melMass comfy_mtb that is greater than 0.1.4.
    3. Review and enhance input validation to prevent command injection attacks.
rule: version <= "0.1.4"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-12952
  - https://github.com/melMass/comfy_mtb/issues/224
  - https://github.com/melMass/comfy_mtb/issues/224#issuecomment-2552664778
  - https://github.com/melMass/comfy_mtb/issues/224#issuecomment-2553432365
  - https://github.com/melMass/comfy_mtb/commit/d6e004cce2c32f8e48b868e66b89f82da4887dc3
  - https://vuldb.com/?ctiid.289315
  - https://vuldb.com/?id.289315
  - https://vuldb.com/?submit.468683