info:
  name: gradio-infinite-image-browsing-vulnerability
  cve: CVE-2023-46315
  summary: Remote file read vulnerability in Gradio with Infinite Image Browsing extension
  details: |
    The zanllp sd-webui-infinite-image-browsing (aka Infinite Image Browsing) extension before commit 977815a for stable-diffusion-webui (aka Stable Diffusion web UI), if Gradio authentication is enabled without secret key configuration, allows remote attackers to read any local file via /file?path= in the URL. This can be exploited to discover credentials, as demonstrated by reading /proc/self/environ.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade sd-webui-infinite-image-browsing extension to version 977815a or later.
    2. Ensure that Gradio authentication is configured with a secret key.
    3. Regularly update and patch all components of the stable-diffusion-webui to mitigate potential vulnerabilities.
rule: version < "977815a"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-46315
  - https://github.com/zanllp/sd-webui-infinite-image-browsing/issues/387
  - https://github.com/zanllp/sd-webui-infinite-image-browsing/pull/368/commits/977815a2b28ad953c10ef0114c365f698c4b8f19