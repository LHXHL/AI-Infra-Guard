info:
  name: gradio
  cve: CVE-2023-46315
  summary: Remote file read vulnerability in gradio with authentication enabled without secret key
  details: |
    The zanllp sd-webui-infinite-image-browsing extension before commit 977815a for stable-diffusion-webui,
    when Gradio authentication is enabled without a secret key configuration, allows remote attackers to read any
    local file via /file?path= in the URL. This can be exploited to discover credentials, as demonstrated by reading
    /proc/self/environ.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. Ensure that Gradio is configured with a secret key when enabling authentication.
    2. Upgrade to the latest version of sd-webui-infinite-image-browsing containing commit 977815a or later.
    3. Regularly review and update configurations to prevent unauthorized access.
rule: version < "977815a"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-46315
  - https://github.com/zanllp/sd-webui-infinite-image-browsing/issues/387
  - https://github.com/zanllp/sd-webui-infinite-image-browsing/pull/368/commits/977815a2b28ad953c10ef0114c365f698c4b8f19