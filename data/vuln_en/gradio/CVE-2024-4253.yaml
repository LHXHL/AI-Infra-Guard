info:
  name: gradio-command-injection-vulnerability
  cve: CVE-2024-4253
  summary: Command injection vulnerability in Gradio's 'test-functional.yml' workflow
  details: |
    A command injection vulnerability exists in the gradio-app/gradio repository, specifically within the 'test-functional.yml' workflow due to improper neutralization of special elements in a command. This allows for unauthorized modification of the base repository or secrets exfiltration, potentially leading to the exposure of sensitive tokens like 'GITHUB_TOKEN', 'COMMENT_TOKEN', and 'CHROMATIC_PROJECT_TOKEN'.
  cvss: CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
  severity: HIGH
  security_advise: |
    1. Upgrade to gradio-video@0.6.13 or later.
    2. Review and sanitize all inputs in GitHub context handling within workflows.
    3. Regularly audit and update dependencies to patch known vulnerabilities.
rule: version <= "0.6.12"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-4253
  - https://github.com/gradio-app/gradio/commit/a0e70366a8a406fdd80abb21e8c88a3c8e682a2b
  - https://huntr.com/bounties/23cb3749-8ae9-4e1a-9023-4a20ca6b675e