info:
  name: gradio-local-access-vulnerability
  cve: CVE-2024-1727
  summary: Gradio applications running locally vulnerable to third-party websites accessing routes and uploading files
  details: |
    This CVE covers the ability of third-party websites to access routes and upload files to users running Gradio applications locally. For example, a malicious website could include a script that uploads a large file to a locally running Gradio instance, potentially causing unauthorized data exfiltration or resource consumption on the user's computer.
    
    The vulnerability arises from improper handling of cross-origin requests in Gradio applications, allowing external scripts to interact with local Gradio endpoints未经授权的数据泄露或用户计算机上的资源消耗。
    该漏洞源于Gradio应用程序中跨来源请求的不当处理，允许外部脚本与本地Gradio端点交互。这可能导致未经授权的数据泄露或用户计算机上的资源消耗。
    ### 影响
    此CVE涵盖了第三方网站访问路由并向运行Gradio应用程序的本地用户上传文件的能力。例如，恶意网站[www.dontvisitme.com](http://www.dontvisitme.com/)的拥有者可以在其网站上放置一个脚本，该脚本将大文件上传到http://localhost:7860/upload，任何访问其网站并运行Gradio应用程序的人现在将在其计算机上上传该大文件
    
    ### 补丁
    Gradio版本4.19.2或更高版本已修复此问题。我们不知道此漏洞是否被用于针对Gradio应用程序的用户，但我们鼓励所有用户升级到Gradio 4.19.2或更高版本。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L
  severity: MEDIUM
  security_advise: |
    1. Upgrade to Gradio version 4.19.2 or higher.
    2. Review and adjust CORS settings to restrict unauthorized access.
    3. Monitor for any suspicious activity related to file uploads in Gradio applications.
rule: version < "4.19.2"
references:
  - https://github.com/gradio-app/gradio/security/advisories/GHSA-48cq-79qq-6f7x
  - https://nvd.nist.gov/vuln/detail/CVE-2024-1727
  - https://github.com/gradio-app/gradio/pull/7503
  - https://github.com/gradio-app/gradio/commit/84802ee6a4806c25287344dce581f9548a99834a
  - https://github.com/gradio-app/gradio
  - https://huntr.com/bounties/a94d55fb-0770-4cbe-9b20-97a978a2ffff