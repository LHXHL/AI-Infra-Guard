info:
  name: gradio-arbitrary-file-read
  cve: CVE-2024-51751
  summary: Gradio vulnerable to arbitrary file read with File and UploadButton components
  details: |
    If File or UploadButton components are used in a Gradio application to preview file content, an attacker with access to the application might abuse these components to read arbitrary files from the application server. This occurs because Gradio's `processing_utils.async_move_files_to_cache` function, which sanitizes all incoming file paths, relies on the `client_utils.is_file_obj_with_meta` filter to trigger file path checks. However, this filter is not guaranteed to trigger for every input that contains a file path, allowing attackers to read arbitrary files if the `meta` key is omitted or incorrect.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade to gradio>=5.5.0
    2. Review and modify Gradio applications to ensure that all file inputs include the `meta` key with the value `_type: "gradio.FileData"`
    3. Implement additional file path validation to prevent arbitrary file reads
rule: version >= "5.0.0" && version < "5.5.0"
references:
  - https://github.com/gradio-app/gradio/security/advisories/GHSA-rhm9-gp5p-5248
  - https://nvd.nist.gov/vuln/detail/CVE-2024-51751
  - https://github.com/gradio-app/gradio