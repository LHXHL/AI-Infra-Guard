info:
  name: gradio-arbitrary-file-leak
  cve: CVE-2024-47868
  summary: Gradio components allow arbitrary file leaks through post-process steps
  details: |
    This is a data validation vulnerability affecting several Gradio components, which allows arbitrary file leaks through the post-processing step. Attackers can exploit these components by crafting requests that bypass expected input constraints. This issue could lead to sensitive files being exposed to unauthorized users, especially when combined with other vulnerabilities.
    
    Vulnerable components include DownloadButton, Audio, ImageEditor, Video, Model3D, File, UploadButton, Chatbot, MultimodalTextbox, Code, ParamViewer, and Dataset.
    
    Exploit scenarios include bypassing input constraints to download sensitive files or leaking sensitive files from a server through arbitrary file leaks.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
  severity: MEDIUM
  security_advise: |
    1. Upgrade to gradio>=5.0.0
    2. Review and enforce strict input validation for all Gradio components handling file data
    3. Monitor for any suspicious file access patterns post-upgrade
rule: version >= "0" && version < "5.0.0"
references:
  - https://github.com/gradio-app/gradio/security/advisories/GHSA-4q3c-cj7g-jcwf
  - https://nvd.nist.gov/vuln/detail/CVE-2024-47868
  - https://github.com/gradio-app/gradio
  - https://github.com/pypa/advisory-database/tree/main/vulns/gradio/PYSEC-2024-217.yaml