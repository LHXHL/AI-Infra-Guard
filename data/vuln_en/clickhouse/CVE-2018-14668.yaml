info:
  name: clickhouse-cprf-vulnerability
  cve: CVE-2018-14668
  summary: ClickHouse remote table function allowed arbitrary symbols leading to Cross Protocol Request Forgery Attacks.
  details: |
    In ClickHouse versions before 1.1.54388, the "remote" table function allowed arbitrary symbols in the "user", "password", and "default_database" fields. This vulnerability could be exploited to perform Cross Protocol Request Forgery (CPRF) attacks, potentially leading to unauthorized access and data manipulation.
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
  severity: HIGH
  security_advise: |
    1. Upgrade to ClickHouse version 1.1.54388 or later.
    2. Review and enforce strict validation rules for user inputs in remote table functions.
    3. Implement additional security measures such as network segmentation and access controls to limit exposure.
rule: version < "1.1.54388"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2018-14668
  - https://clickhouse.yandex/docs/en/security_changelog