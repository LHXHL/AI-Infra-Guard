info:
  name: clickhouse
  cve: CVE-2021-42389
  summary: Divide-by-zero vulnerability in Clickhouse's Delta compression codec
  details: |
    The vulnerability arises from a divide-by-zero error in Clickhouse's Delta compression codec when parsing a malicious query. The first byte of the compressed buffer is used in a modulo operation without being checked for zero, potentially leading to a crash or undefined behavior.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
  severity: MEDIUM
  security_advise: |
    1. Upgrade to the latest version of Clickhouse to mitigate this vulnerability.
    2. Review and sanitize all incoming queries to prevent malicious input.
    3. Implement additional error handling around codec operations to gracefully handle unexpected input.
rule: version < "latest stable version"  # Placeholder for the actual latest stable version at the time of the vulnerability
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-42389
  - https://jfrog.com/blog/7-rce-and-dos-vulnerabilities-found-in-clickhouse-dbms