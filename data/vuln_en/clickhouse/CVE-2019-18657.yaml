info:
  name: clickhouse-http-header-injection
  cve: CVE-2019-18657
  summary: ClickHouse before 19.13.5.44 allows HTTP header injection via the url table function.
  details: |
    The vulnerability allows attackers to inject malicious HTTP headers via the url table function in ClickHouse versions prior to 19.13.5.44. This could lead to unauthorized access and manipulation of HTTP responses.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
  severity: MEDIUM
  security_advise: |
    1. Upgrade to ClickHouse version 19.13.5.44 or later.
    2. Review and update all configurations involving the url table function to ensure they are not vulnerable to header injection.
    3. Implement input validation to sanitize any user-provided data used in HTTP headers.
rule: version < "19.13.5.44"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2019-18657
  - https://github.com/ClickHouse/ClickHouse/pull/6466
  - https://github.com/ClickHouse/ClickHouse/pull/7526/files
  - https://github.com/ClickHouse/ClickHouse/blob/master/CHANGELOG.md