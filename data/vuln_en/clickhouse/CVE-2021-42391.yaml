info:
  name: clickhouse-divide-by-zero-vulnerability
  cve: CVE-2021-42391
  summary: Divide-by-zero vulnerability in Clickhouse's Gorilla compression codec
  details: |
    The vulnerability arises from a divide-by-zero error in Clickhouse's Gorilla compression codec when parsing a malicious query. 
    The first byte of the compressed buffer is used in a modulo operation without being checked for zero, potentially leading to a crash or undefined behavior.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
  severity: MEDIUM
  security_advise: |
    1. Upgrade to the latest version of Clickhouse to mitigate this vulnerability.
    2. Implement input validation to ensure that compressed data does not contain malicious sequences.
    3. Monitor system logs for any signs of unusual activity that could indicate an exploit attempt.
rule: version < "21.3.4.1"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-42391
  - https://jfrog.com/blog/7-rce-and-dos-vulnerabilities-found-in-clickhouse-dbms