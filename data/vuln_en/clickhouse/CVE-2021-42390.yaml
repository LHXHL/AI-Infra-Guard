info:
  name: clickhouse-divide-by-zero-vulnerability
  cve: CVE-2021-42390
  summary: Divide-by-zero vulnerability in Clickhouse's DeltaDouble compression codec
  details: |
    The vulnerability arises from a divide-by-zero error in Clickhouse's DeltaDouble compression codec when parsing a malicious query. 
    The first byte of the compressed buffer is used in a modulo operation without being checked for zero, potentially leading to a crash or undefined behavior.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
  severity: MEDIUM
  security_advise: |
    1. Upgrade to the latest version of Clickhouse where this vulnerability has been fixed.
    2. Implement input validation to prevent malicious queries from being processed.
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-42390
  - https://jfrog.com/blog/7-rce-and-dos-vulnerabilities-found-in-clickhouse-dbms
rule: version < "21.3.4.1" # Assuming this is the version where the vulnerability was fixed