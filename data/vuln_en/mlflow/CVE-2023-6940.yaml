info:
  name: mlflow-command-injection
  cve: CVE-2023-6940
  summary: mlflow Command Injection vulnerability
  details: |
    With only one user interaction (download a malicious config), attackers can gain full command execution on the victim system.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
  severity: HIGH
  security_advise: |
    1. Upgrade to mlflow version 2.9.2 or higher.
    2. Review and validate all configuration files to ensure they do not contain malicious content.
    3. Implement strict access controls to limit who can upload or modify configuration files.
rule: version < "2.9.2"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-6940
  - https://github.com/mlflow/mlflow/pull/10676
  - https://github.com/mlflow/mlflow/commit/5139b1087d686fa52e2b087e09da66aff86297b1
  - https://github.com/mlflow/mlflow/commit/a98a341a7222f894b7735db575ad9311ecaba4e3
  - https://github.com/mlflow/mlflow
  - https://github.com/mlflow/mlflow/commits/v2.9.2
  - https://huntr.com/bounties/c6f59480-ce47-4f78-a3dc-4bd8ca15029c