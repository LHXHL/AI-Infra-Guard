info:
  name: dify
  cve: CVE-2024-11850
  summary: Dify 中的存储型 XSS 漏洞
  details: |
    在 Dify 的聊天机器人中，启用了对用户输入的 SVG 标记支持。用户输入的内容未经任何验证或消毒直接插入，这允许攻击者插入 HTML 代码而不经过过滤。例如，攻击者可以通过插入恶意的 SVG 代码，当管理员查看聊天记录时触发 XSS 攻击，可能导致管理员凭证被盗取。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N
  severity: MEDIUM
  security_advise: 禁用用户输入的 SVG 标记支持或对所有用户输入进行严格的验证和消毒处理，以防止潜在的 XSS 攻击。
rule: 
references:
 - https://github.com/langgenius/dify/security/advisories/GHSA-xxxx-xxxx-xxxx
 - https://nvd.nist.gov/vuln/detail/CVE-2024-11850