info:
  name: dify
  cve: CVE-2024-12775
  summary: dify的Create Custom Tool功能中的非盲SSRF漏洞
  details: |
    dify在Create Custom Tool选项的测试功能中存在非盲SSRF漏洞（通过REST API POST /console/api/workspaces/current/tool-provider/api/test/pre）。攻击者可以在OpenAI模式中的servers字典设置任意URL目标以进行窃取，从而能够滥用受害dify服务器的凭据访问网络资源。
    攻击者首先以普通用户身份登录dify网络服务器，然后导航到Tools -> Custom并点击Create Custom Tool按钮。接着，攻击者选择示例并修改servers->url为受害者的内部目标URL，点击Test操作后即可获取受害目标的秘密结果。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
  severity: MEDIUM
  security_advise: 应用白名单或黑名单来防止非法的server_url值，确保只有授权的URL可以被访问。
rule: version == "0.10.1"
references:
 - https://huntr.dev/bounties/2024/12775/
 - https://nvd.nist.gov/vuln/detail/CVE-2024-12775