info:
  name: dify
  cve: CVE-2025-1796
  summary: Dify 使用弱伪随机数生成器生成密码重置码导致管理员账户接管漏洞
  details: |
    Dify 使用 `random.randint` 来生成其密码重置码。这些伪随机数生成器不适合用于加密目的，可以被破解，从而允许拥有使用工作流工具（需要获取随机数生成器的输出）权限的用户入侵任何账户，包括管理员账户。
    攻击者可以通过提取伪随机数生成器的输出并使用修改后的 Mersenne Twister 破解器来重建其内部状态，从而生成有效的密码重置码。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
  severity: HIGH
  security_advise: 升级到最新版本的 Dify 或者修改密码重置码生成逻辑，使用加密安全的随机数生成器（如 `secrets` 模块）来生成密码重置码。
rule: version < "0.10.2"
references:
 - https://github.com/langgenius/dify/security/advisories/GHSA-xxxx-xxxx-xxxx
 - https://nvd.nist.gov/vuln/detail/CVE-2025-1796
 - https://github.com/fx5/not_random