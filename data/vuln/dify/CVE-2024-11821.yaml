info:
  name: dify
  cve: CVE-2024-11821
  summary: Dify 中的权限提升漏洞，可修改 Orchestrate 指令
  details: |
    在 Dify 中存在一个权限提升漏洞，允许低权限用户修改 Orchestrate 指令。具体来说，用户 A 创建一个聊天机器人并添加 Orchestrate 指令，然后添加用户 B 为普通用户。尽管用户 B 无法直接修改 Orchestrate 指令，但通过发送特定的请求，用户 B 可以绕过权限限制并修改指令。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
  severity: MEDIUM
  security_advise: 升级到 dify >= 0.9.2 版本以解决此问题。同时，建议检查并加强权限验证机制，确保只有授权用户才能修改关键指令。
  references:
    - https://github.com/langgenius/dify/security/advisories/GHSA-xxxx-xxxx-xxxx
    - https://nvd.nist.gov/vuln/detail/CVE-2024-11821
    - https://github.com/langgenius/dify
rule: version < "0.9.2"