info:
  name: dify
  cve: CVE-2024-12776
  summary: Dify 后台密码重置代码未检查导致管理员账号接管漏洞
  details: |
    当请求密码重置时，应用程序会向用户提供一个令牌，并将相应的代码发送到电子邮件收件箱。然后用户会被路由到一个页面，该页面将通过 /forgot-password/validity API 端点检查代码，如果成功，用户将被转发到 /forgot-password/resets。然而，/forgot-password/resets 并不检查代码，可以通过直接访问 /forgot-password/resets 并重置任意用户的密码来轻松绕过检查。
    攻击者可以通过获取任意用户的令牌并重置其密码，从而完全控制应用程序。
  cvss: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H
  severity: HIGH
  security_advise: 升级到 dify >= v0.10.2 以解决此问题，确保在 /forgot-password/resets 端点中验证密码重置代码。
rule: version < "0.10.2"
references:
 - https://github.com/langgenius/dify/security/advisories/GHSA-xxxx-xxxx-xxxx
 - https://nvd.nist.gov/vuln/detail/CVE-2024-12776
 - https://github.com/langgenius/dify