info:
  name: vllm
  cve: CVE-2025-24357
  summary: vllm通过torch.load在hf_model_weights_iterator中的恶意模型实现RCE
  details: |
    vllm/model_executor/weight_utils.py实现了hf_model_weights_iterator来加载从huggingface下载的模型检查点。它使用torch.load函数，且weights_only参数默认值为False。根据https://pytorch.org/docs/stable/generated/torch.load.html上的安全警告，当torch.load加载恶意pickle数据时，将在unpickling过程中执行任意代码。
  cvss: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
  severity: HIGH
  security_advise: 升级到vllm>=0.7.0以解决此问题，该版本已修复了通过torch.load加载模型检查点时的安全漏洞。
rule: version < "0.7.0"
references:
 - https://github.com/vllm-project/vllm/security/advisories/GHSA-rh4j-5rhw-hr54
 - https://nvd.nist.gov/vuln/detail/CVE-2025-24357
 - https://github.com/vllm-project/vllm/pull/12366
 - https://github.com/vllm-project/vllm/commit/d3d6bb13fb62da3234addf6574922a4ec0513d04
 - https://github.com/vllm-project/vllm
 - https://github.com/vllm-project/vllm/releases/tag/v0.7.0
 - https://pytorch.org/docs/stable/generated/torch.load.html