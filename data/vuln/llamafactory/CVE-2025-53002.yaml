info:
  name: llamafactory
  cve: CVE-2025-53002
  summary: LLaMA-Factory 允许通过不恰当的 vhead_file 安全措施导致代码注入
  details: |
    在 Llama Factory 训练过程中发现了一个严重的远程代码执行漏洞。
    此漏洞源于 `vhead_file` 在加载时未采取适当的安全措施，使得恶意攻击者只需通过 `WebUI` 界面传递恶意的 `Checkpoint path` 参数，即可在宿主系统上执行任意恶意代码。
    根本原因是 `vhead_file` 参数在加载时未使用安全参数 `weights_only=True`。
    在 torch 版本 <2.6 中，默认设置为 `weights_only=False`，而 Llama Factory 的 `setup.py` 仅要求 `torch>=2.0.0`。
    受影响的版本为 Llama Factory 版本 <=0.9.3。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:H
  severity: HIGH
  security_advise: |
    1. 升级到 Llama Factory 版本 > 0.9.3
    2. 确保调用 `torch.load()` 时使用 `weights_only=True` 以防止任意代码执行
    3. 验证并清理 WebUI 中所有的 `Checkpoint path` 输入
rule: version <= "0.9.3"
references:
  - https://github.com/hiyouga/LLaMA-Factory/security/advisories/GHSA-xj56-p8mm-qmxj
  - https://nvd.nist.gov/vuln/detail/CVE-2025-53002
  - https://github.com/hiyouga/LLaMA-Factory/commit/bb7bf51554d4ba8432333c35a5e3b52705955ede
  - https://github.com/hiyouga/LLaMA-Factory