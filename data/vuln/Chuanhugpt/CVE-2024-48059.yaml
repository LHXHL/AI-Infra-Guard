info:
  name: Chuanhugpt
  cve: CVE-2024-48059
  summary: Chuanhugpt 存储型跨站脚本（XSS）漏洞
  details: |
    gaizhenbiao/chuanhuchatgpt 项目，版本 <=20240802 存在 WebSocket 会话传输中的存储型跨站脚本（XSS）漏洞。攻击者可以向 WebSocket 消息中注入恶意内容。当受害者访问此会话时，恶意 JavaScript 将在受害者的浏览器中执行。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  severity: MEDIUM
  security_advise: 升级到 chuanhugpt 版本大于 20240802 以解决此问题。
rule: version <= "20240802"
references:
 - https://nvd.nist.gov/vuln/detail/CVE-2024-48059
 - https://gist.github.com/AfterSnows/c5a4cb029fb9142be5c54e531a9a240e
 - https://rumbling-slice-eb0.notion.site/Stored-XSS-via-Chat-message-in-gaizhenbiao-chuanhuchatgpt-104e3cda9e8c80b4b611dfc491c488d8?pvs=4