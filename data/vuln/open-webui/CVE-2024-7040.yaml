info:
  name: open-webui
  cve: CVE-2024-7040
  summary: open-webui 中的不当访问控制漏洞
  details: |
    在 open-webui/open-webui 的 v0.3.8 版本中，存在不当访问控制漏洞。
    在前端管理页面上，管理员旨在仅查看非管理员成员的聊天记录。
    然而，通过修改 user_id 参数，可以查看任何管理员的聊天记录，
    包括其他管理员（所有者）账户的聊天记录。
  cvss: CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
  severity: MEDIUM
  security_advise: |
    1. 升级到 open-webui >= v0.3.9
    2. 在管理页面上实施严格的访问控制检查
    3. 验证并清理所有用户输入参数
rule: version < "0.3.9"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-7040
  - https://huntr.com/bounties/bd182309-4aa4-4747-941e-bbc1741955c1